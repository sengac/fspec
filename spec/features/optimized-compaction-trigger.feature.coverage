{
  "scenarios": [
    {
      "name": "Calculate usable context for Claude Sonnet",
      "testMappings": [
        {
          "file": "codelet/cli/src/compaction_threshold.rs",
          "lines": "240-257",
          "implMappings": [
            {
              "file": "codelet/cli/src/compaction_threshold.rs",
              "lines": [
                172,
                173,
                174,
                175,
                176,
                177,
                178,
                179
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "Calculate usable context for GPT-4",
      "testMappings": [
        {
          "file": "codelet/cli/src/compaction_threshold.rs",
          "lines": "262-278",
          "implMappings": [
            {
              "file": "codelet/cli/src/compaction_threshold.rs",
              "lines": [
                172,
                173,
                174,
                175,
                176,
                177,
                178,
                179
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "SESSION_OUTPUT_MAX caps high-output models",
      "testMappings": [
        {
          "file": "codelet/cli/src/compaction_threshold.rs",
          "lines": "284-300",
          "implMappings": [
            {
              "file": "codelet/cli/src/compaction_threshold.rs",
              "lines": [
                172,
                173,
                174,
                175,
                176,
                177,
                178,
                179
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "Unknown model with zero max_output uses SESSION_OUTPUT_MAX fallback",
      "testMappings": [
        {
          "file": "codelet/cli/src/compaction_threshold.rs",
          "lines": "306-323",
          "implMappings": [
            {
              "file": "codelet/cli/src/compaction_threshold.rs",
              "lines": [
                172,
                173,
                174,
                175,
                176,
                177,
                178,
                179
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "Token count includes all three token types",
      "testMappings": [
        {
          "file": "codelet/cli/src/compaction_threshold.rs",
          "lines": "329-345",
          "implMappings": [
            {
              "file": "codelet/cli/src/compaction_threshold.rs",
              "lines": [
                150,
                151,
                152,
                153,
                154,
                155,
                156
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "Token count does not discount cache tokens",
      "testMappings": [
        {
          "file": "codelet/cli/src/compaction_threshold.rs",
          "lines": "351-368",
          "implMappings": [
            {
              "file": "codelet/cli/src/compaction_threshold.rs",
              "lines": [
                150,
                151,
                152,
                153,
                154,
                155,
                156
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "No compaction when under usable context threshold",
      "testMappings": [
        {
          "file": "codelet/cli/src/compaction_threshold.rs",
          "lines": "374-394",
          "implMappings": [
            {
              "file": "codelet/cli/src/compaction_threshold.rs",
              "lines": [
                198,
                199,
                200,
                201,
                202,
                203,
                204,
                205,
                206,
                207,
                208,
                209,
                210,
                211,
                212,
                213,
                214,
                215,
                216,
                217,
                218,
                219
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "Trigger compaction when over usable context threshold",
      "testMappings": [
        {
          "file": "codelet/cli/src/compaction_threshold.rs",
          "lines": "400-420",
          "implMappings": [
            {
              "file": "codelet/cli/src/compaction_threshold.rs",
              "lines": [
                198,
                199,
                200,
                201,
                202,
                203,
                204,
                205,
                206,
                207,
                208,
                209,
                210,
                211,
                212,
                213,
                214,
                215,
                216,
                217,
                218,
                219
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "Compaction triggers later than legacy 90% threshold",
      "testMappings": [
        {
          "file": "codelet/cli/src/compaction_threshold.rs",
          "lines": "426-452",
          "implMappings": [
            {
              "file": "codelet/cli/src/compaction_threshold.rs",
              "lines": [
                198,
                199,
                200,
                201,
                202,
                203,
                204,
                205,
                206,
                207,
                208,
                209,
                210,
                211,
                212,
                213,
                214,
                215,
                216,
                217,
                218,
                219
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "No compaction when token count exactly equals usable context",
      "testMappings": [
        {
          "file": "codelet/cli/src/compaction_threshold.rs",
          "lines": "458-485",
          "implMappings": [
            {
              "file": "codelet/cli/src/compaction_threshold.rs",
              "lines": [
                198,
                199,
                200,
                201,
                202,
                203,
                204,
                205,
                206,
                207,
                208,
                209,
                210,
                211,
                212,
                213,
                214,
                215,
                216,
                217,
                218,
                219
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "No compaction when context_window is zero",
      "testMappings": [
        {
          "file": "codelet/cli/src/compaction_threshold.rs",
          "lines": "491-513",
          "implMappings": [
            {
              "file": "codelet/cli/src/compaction_threshold.rs",
              "lines": [
                198,
                199,
                200,
                201,
                202,
                203,
                204,
                205,
                206,
                207,
                208,
                209,
                210,
                211,
                212,
                213,
                214,
                215,
                216,
                217,
                218,
                219
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "No compaction when disable flag is set",
      "testMappings": [
        {
          "file": "codelet/cli/src/compaction_threshold.rs",
          "lines": "519-550",
          "implMappings": [
            {
              "file": "codelet/cli/src/compaction_threshold.rs",
              "lines": [
                198,
                199,
                200,
                201,
                202,
                203,
                204,
                205,
                206,
                207,
                208,
                209,
                210,
                211,
                212,
                213,
                214,
                215,
                216,
                217,
                218,
                219
              ]
            }
          ]
        }
      ]
    }
  ],
  "stats": {
    "totalScenarios": 12,
    "coveredScenarios": 12,
    "coveragePercent": 100,
    "testFiles": [
      "codelet/cli/src/compaction_threshold.rs"
    ],
    "implFiles": [
      "codelet/cli/src/compaction_threshold.rs"
    ],
    "totalLinesCovered": 435
  }
}