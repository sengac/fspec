{
  "version": "2.0.0",
  "project": {
    "name": "codelet",
    "vision": "A multi-provider AI coding agent CLI in Rust that enables developers to leverage multiple LLM providers (Claude, OpenAI, Gemini) with advanced context management, tool execution, and conversation compaction for AI-assisted software development.",
    "projectType": "cli-tool"
  },
  "problemSpace": {
    "primaryProblem": {
      "title": "Vendor lock-in and lack of flexibility in AI coding agents",
      "description": "Existing AI coding agents are often monolithic and locked to a single LLM provider. Developers cannot easily switch between providers (Anthropic, OpenAI, Google) based on cost, capabilities, or availability. Additionally, context management becomes unwieldy as conversations grow, leading to token waste and degraded responses.",
      "impact": "high"
    }
  },
  "solutionSpace": {
    "overview": "A lightweight, high-performance Rust CLI that provides a unified interface to multiple LLM providers through Rig.rs, with intelligent context management including automatic conversation compaction, prompt caching, and token tracking. The tool exposes file operations, code search, and command execution as tools the AI can use, following the patterns established by OpenAI Codex CLI.",
    "capabilities": [
      {
        "name": "Multi-Provider LLM Integration",
        "description": "Connect to multiple LLM providers (Anthropic Claude, OpenAI GPT, Google Gemini) through a unified interface using Rig.rs"
      },
      {
        "name": "Tool Execution Framework",
        "description": "Execute file operations (read, write, edit), code search (grep, glob), and bash commands as AI-callable tools"
      },
      {
        "name": "Context Management",
        "description": "Intelligent context window management with automatic conversation compaction, token tracking, and prompt caching"
      },
      {
        "name": "Interactive and Non-Interactive Modes",
        "description": "Support both interactive REPL mode for development and non-interactive exec mode for scripting and CI/CD"
      }
    ]
  },
  "personas": [
    {
      "name": "Software Developer",
      "description": "A developer who uses AI to assist with coding tasks including writing, debugging, and refactoring code",
      "goals": [
        "Quickly get AI assistance for coding tasks",
        "Switch between LLM providers based on task needs"
      ]
    },
    {
      "name": "DevOps Engineer",
      "description": "An engineer who integrates AI coding assistance into CI/CD pipelines and automated workflows",
      "goals": [
        "Run AI-assisted code generation in non-interactive mode",
        "Integrate LLM capabilities into build scripts"
      ]
    }
  ],
  "eventStorm": {
    "level": "big_picture",
    "items": [
      {
        "id": 1,
        "type": "bounded_context",
        "text": "Agent Execution",
        "color": null,
        "deleted": false,
        "createdAt": "2025-12-17T02:30:15.727Z"
      },
      {
        "id": 2,
        "type": "bounded_context",
        "text": "Provider Management",
        "color": null,
        "deleted": false,
        "createdAt": "2025-12-17T02:30:18.408Z"
      },
      {
        "id": 3,
        "type": "bounded_context",
        "text": "Tool Execution",
        "color": null,
        "deleted": false,
        "createdAt": "2025-12-17T02:30:21.210Z"
      },
      {
        "id": 4,
        "type": "bounded_context",
        "text": "CLI Interface",
        "color": null,
        "deleted": false,
        "createdAt": "2025-12-17T02:30:23.913Z"
      },
      {
        "id": 5,
        "type": "aggregate",
        "text": "RigAgent",
        "boundedContextId": 1,
        "color": "yellow",
        "deleted": false,
        "createdAt": "2025-12-17T02:30:42.196Z",
        "description": "Orchestrates LLM communication and multi-turn tool execution"
      },
      {
        "id": 6,
        "type": "aggregate",
        "text": "Compaction",
        "boundedContextId": 1,
        "color": "yellow",
        "deleted": false,
        "createdAt": "2025-12-17T02:30:44.885Z",
        "description": "Manages conversation history size through summarization and anchor points"
      },
      {
        "id": 7,
        "type": "aggregate",
        "text": "ProviderManager",
        "boundedContextId": 2,
        "color": "yellow",
        "deleted": false,
        "createdAt": "2025-12-17T02:30:54.695Z",
        "description": "Selects and manages LLM provider instances"
      },
      {
        "id": 8,
        "type": "aggregate",
        "text": "ClaudeProvider",
        "boundedContextId": 2,
        "color": "yellow",
        "deleted": false,
        "createdAt": "2025-12-17T02:30:57.439Z",
        "description": "Anthropic Claude API integration with prompt caching support"
      },
      {
        "id": 9,
        "type": "aggregate",
        "text": "OpenAIProvider",
        "boundedContextId": 2,
        "color": "yellow",
        "deleted": false,
        "createdAt": "2025-12-17T02:31:01.225Z",
        "description": "OpenAI GPT API integration"
      },
      {
        "id": 10,
        "type": "aggregate",
        "text": "GeminiProvider",
        "boundedContextId": 2,
        "color": "yellow",
        "deleted": false,
        "createdAt": "2025-12-17T02:31:04.669Z",
        "description": "Google Gemini API integration"
      },
      {
        "id": 11,
        "type": "aggregate",
        "text": "CodexProvider",
        "boundedContextId": 2,
        "color": "yellow",
        "deleted": false,
        "createdAt": "2025-12-17T02:31:07.448Z",
        "description": "OpenAI Codex/ChatGPT backend with OAuth authentication"
      },
      {
        "id": 12,
        "type": "aggregate",
        "text": "CachingClient",
        "boundedContextId": 2,
        "color": "yellow",
        "deleted": false,
        "createdAt": "2025-12-17T02:31:10.397Z",
        "description": "HTTP middleware for Anthropic prompt cache control"
      },
      {
        "id": 13,
        "type": "aggregate",
        "text": "BashTool",
        "boundedContextId": 3,
        "color": "yellow",
        "deleted": false,
        "createdAt": "2025-12-17T02:31:22.939Z",
        "description": "Executes shell commands with timeout and output handling"
      },
      {
        "id": 14,
        "type": "aggregate",
        "text": "ReadTool",
        "boundedContextId": 3,
        "color": "yellow",
        "deleted": false,
        "createdAt": "2025-12-17T02:31:26.790Z",
        "description": "Reads file contents with line range support"
      },
      {
        "id": 15,
        "type": "aggregate",
        "text": "WriteTool",
        "boundedContextId": 3,
        "color": "yellow",
        "deleted": false,
        "createdAt": "2025-12-17T02:31:29.554Z",
        "description": "Writes content to files"
      },
      {
        "id": 16,
        "type": "aggregate",
        "text": "EditTool",
        "boundedContextId": 3,
        "color": "yellow",
        "deleted": false,
        "createdAt": "2025-12-17T02:31:32.143Z",
        "description": "Performs search-and-replace edits on files"
      },
      {
        "id": 17,
        "type": "aggregate",
        "text": "GrepTool",
        "boundedContextId": 3,
        "color": "yellow",
        "deleted": false,
        "createdAt": "2025-12-17T02:31:34.834Z",
        "description": "Searches file contents using ripgrep"
      },
      {
        "id": 18,
        "type": "aggregate",
        "text": "GlobTool",
        "boundedContextId": 3,
        "color": "yellow",
        "deleted": false,
        "createdAt": "2025-12-17T02:31:37.328Z",
        "description": "Finds files matching glob patterns"
      },
      {
        "id": 19,
        "type": "aggregate",
        "text": "AstGrepTool",
        "boundedContextId": 3,
        "color": "yellow",
        "deleted": false,
        "createdAt": "2025-12-17T02:31:39.997Z",
        "description": "AST-based code search using tree-sitter"
      },
      {
        "id": 20,
        "type": "aggregate",
        "text": "LsTool",
        "boundedContextId": 3,
        "color": "yellow",
        "deleted": false,
        "createdAt": "2025-12-17T02:31:42.382Z",
        "description": "Lists directory contents"
      },
      {
        "id": 21,
        "type": "aggregate",
        "text": "Cli",
        "boundedContextId": 4,
        "color": "yellow",
        "deleted": false,
        "createdAt": "2025-12-17T02:31:54.634Z",
        "description": "Command-line argument parsing using clap"
      },
      {
        "id": 22,
        "type": "aggregate",
        "text": "InteractiveMode",
        "boundedContextId": 4,
        "color": "yellow",
        "deleted": false,
        "createdAt": "2025-12-17T02:31:56.876Z",
        "description": "REPL orchestration for interactive agent sessions"
      },
      {
        "id": 23,
        "type": "aggregate",
        "text": "Session",
        "boundedContextId": 4,
        "color": "yellow",
        "deleted": false,
        "createdAt": "2025-12-17T02:31:59.349Z",
        "description": "Session state including context gathering and system reminders"
      },
      {
        "id": 24,
        "type": "aggregate",
        "text": "CompactionThreshold",
        "boundedContextId": 4,
        "color": "yellow",
        "deleted": false,
        "createdAt": "2025-12-17T02:32:01.514Z",
        "description": "Calculates when conversation compaction should trigger"
      },
      {
        "id": 25,
        "type": "aggregate",
        "text": "Terminal",
        "boundedContextId": 4,
        "color": "yellow",
        "deleted": false,
        "createdAt": "2025-12-17T02:32:04.321Z",
        "description": "Terminal setup, teardown, and panic handling"
      },
      {
        "id": 26,
        "type": "aggregate",
        "text": "InputQueue",
        "boundedContextId": 4,
        "color": "yellow",
        "deleted": false,
        "createdAt": "2025-12-17T02:32:06.937Z",
        "description": "Manages user input buffering during agent execution"
      },
      {
        "id": 27,
        "type": "aggregate",
        "text": "StatusDisplay",
        "boundedContextId": 4,
        "color": "yellow",
        "deleted": false,
        "createdAt": "2025-12-17T02:32:09.371Z",
        "description": "Displays status information in the terminal"
      },
      {
        "id": 28,
        "type": "event",
        "text": "AgentStarted",
        "boundedContextId": 1,
        "color": "orange",
        "deleted": false,
        "createdAt": "2025-12-17T02:32:35.881Z",
        "description": "Agent begins execution loop"
      },
      {
        "id": 29,
        "type": "event",
        "text": "PromptReceived",
        "boundedContextId": 1,
        "color": "orange",
        "deleted": false,
        "createdAt": "2025-12-17T02:32:38.613Z",
        "description": "User submits a prompt to the agent"
      },
      {
        "id": 30,
        "type": "event",
        "text": "ResponseStreaming",
        "boundedContextId": 1,
        "color": "orange",
        "deleted": false,
        "createdAt": "2025-12-17T02:32:41.661Z",
        "description": "Agent is streaming response chunks"
      },
      {
        "id": 31,
        "type": "event",
        "text": "ResponseCompleted",
        "boundedContextId": 1,
        "color": "orange",
        "deleted": false,
        "createdAt": "2025-12-17T02:32:43.943Z",
        "description": "Agent finished generating response"
      },
      {
        "id": 32,
        "type": "event",
        "text": "CompactionTriggered",
        "boundedContextId": 1,
        "color": "orange",
        "deleted": false,
        "createdAt": "2025-12-17T02:32:46.539Z",
        "description": "Conversation compaction process initiated"
      },
      {
        "id": 33,
        "type": "event",
        "text": "ConversationCompacted",
        "boundedContextId": 1,
        "color": "orange",
        "deleted": false,
        "createdAt": "2025-12-17T02:32:50.328Z",
        "description": "Conversation history successfully summarized and reduced"
      },
      {
        "id": 34,
        "type": "event",
        "text": "ProviderSelected",
        "boundedContextId": 2,
        "color": "orange",
        "deleted": false,
        "createdAt": "2025-12-17T02:32:59.868Z",
        "description": "LLM provider chosen for use"
      },
      {
        "id": 35,
        "type": "event",
        "text": "CompletionRequested",
        "boundedContextId": 2,
        "color": "orange",
        "deleted": false,
        "createdAt": "2025-12-17T02:33:02.695Z",
        "description": "Completion request sent to LLM provider"
      },
      {
        "id": 36,
        "type": "event",
        "text": "StreamChunkReceived",
        "boundedContextId": 2,
        "color": "orange",
        "deleted": false,
        "createdAt": "2025-12-17T02:33:05.551Z",
        "description": "Streaming response chunk received from provider"
      },
      {
        "id": 37,
        "type": "event",
        "text": "CacheHit",
        "boundedContextId": 2,
        "color": "orange",
        "deleted": false,
        "createdAt": "2025-12-17T02:33:08.402Z",
        "description": "Prompt cache was reused, reducing token costs"
      },
      {
        "id": 38,
        "type": "event",
        "text": "CacheTokensExtracted",
        "boundedContextId": 2,
        "color": "orange",
        "deleted": false,
        "createdAt": "2025-12-17T02:33:12.487Z",
        "description": "Cache token counts parsed from API response"
      },
      {
        "id": 39,
        "type": "event",
        "text": "ToolInvoked",
        "boundedContextId": 3,
        "color": "orange",
        "deleted": false,
        "createdAt": "2025-12-17T02:33:21.966Z",
        "description": "Tool called by the agent"
      },
      {
        "id": 40,
        "type": "event",
        "text": "ToolExecuted",
        "boundedContextId": 3,
        "color": "orange",
        "deleted": false,
        "createdAt": "2025-12-17T02:33:24.930Z",
        "description": "Tool completed execution successfully"
      },
      {
        "id": 41,
        "type": "event",
        "text": "ToolFailed",
        "boundedContextId": 3,
        "color": "orange",
        "deleted": false,
        "createdAt": "2025-12-17T02:33:27.712Z",
        "description": "Tool execution encountered an error"
      },
      {
        "id": 42,
        "type": "event",
        "text": "OutputTruncated",
        "boundedContextId": 3,
        "color": "orange",
        "deleted": false,
        "createdAt": "2025-12-17T02:33:31.631Z",
        "description": "Tool output exceeded limits and was truncated"
      },
      {
        "id": 43,
        "type": "event",
        "text": "CommandParsed",
        "boundedContextId": 4,
        "color": "orange",
        "deleted": false,
        "createdAt": "2025-12-17T02:33:42.511Z",
        "description": "CLI arguments parsed and validated"
      },
      {
        "id": 44,
        "type": "event",
        "text": "InteractiveModeStarted",
        "boundedContextId": 4,
        "color": "orange",
        "deleted": false,
        "createdAt": "2025-12-17T02:33:44.833Z",
        "description": "Interactive REPL session began"
      },
      {
        "id": 45,
        "type": "event",
        "text": "SessionCreated",
        "boundedContextId": 4,
        "color": "orange",
        "deleted": false,
        "createdAt": "2025-12-17T02:33:47.009Z",
        "description": "New conversation session initialized"
      },
      {
        "id": 46,
        "type": "event",
        "text": "ContextGathered",
        "boundedContextId": 4,
        "color": "orange",
        "deleted": false,
        "createdAt": "2025-12-17T02:33:50.047Z",
        "description": "Project context files (CLAUDE.md) loaded"
      },
      {
        "id": 47,
        "type": "event",
        "text": "SystemReminderInjected",
        "boundedContextId": 4,
        "color": "orange",
        "deleted": false,
        "createdAt": "2025-12-17T02:33:52.431Z",
        "description": "System reminder added to conversation"
      },
      {
        "id": 48,
        "type": "event",
        "text": "UserInputReceived",
        "boundedContextId": 4,
        "color": "orange",
        "deleted": false,
        "createdAt": "2025-12-17T02:33:55.169Z",
        "description": "User typed input in interactive mode"
      },
      {
        "id": 49,
        "type": "command",
        "text": "RunAgent",
        "boundedContextId": 1,
        "color": "blue",
        "deleted": false,
        "createdAt": "2025-12-17T02:34:16.342Z",
        "description": "Start the agent execution loop"
      },
      {
        "id": 50,
        "type": "command",
        "text": "SendPrompt",
        "boundedContextId": 1,
        "color": "blue",
        "deleted": false,
        "createdAt": "2025-12-17T02:34:18.971Z",
        "description": "Submit a prompt to the agent"
      },
      {
        "id": 51,
        "type": "command",
        "text": "TriggerCompaction",
        "boundedContextId": 1,
        "color": "blue",
        "deleted": false,
        "createdAt": "2025-12-17T02:34:21.806Z",
        "description": "Force conversation compaction"
      },
      {
        "id": 52,
        "type": "command",
        "text": "SelectProvider",
        "boundedContextId": 2,
        "color": "blue",
        "deleted": false,
        "createdAt": "2025-12-17T02:34:29.766Z",
        "description": "Choose which LLM provider to use"
      },
      {
        "id": 53,
        "type": "command",
        "text": "RequestCompletion",
        "boundedContextId": 2,
        "color": "blue",
        "deleted": false,
        "createdAt": "2025-12-17T02:34:33.199Z",
        "description": "Send completion request to LLM"
      },
      {
        "id": 54,
        "type": "command",
        "text": "InvokeTool",
        "boundedContextId": 3,
        "color": "blue",
        "deleted": false,
        "createdAt": "2025-12-17T02:34:43.781Z",
        "description": "Call a tool by name with parameters"
      },
      {
        "id": 55,
        "type": "command",
        "text": "ExecuteBash",
        "boundedContextId": 3,
        "color": "blue",
        "deleted": false,
        "createdAt": "2025-12-17T02:34:47.096Z",
        "description": "Run a shell command"
      },
      {
        "id": 56,
        "type": "command",
        "text": "ReadFile",
        "boundedContextId": 3,
        "color": "blue",
        "deleted": false,
        "createdAt": "2025-12-17T02:34:49.875Z",
        "description": "Read contents of a file"
      },
      {
        "id": 57,
        "type": "command",
        "text": "WriteFile",
        "boundedContextId": 3,
        "color": "blue",
        "deleted": false,
        "createdAt": "2025-12-17T02:34:52.586Z",
        "description": "Write content to a file"
      },
      {
        "id": 58,
        "type": "command",
        "text": "EditFile",
        "boundedContextId": 3,
        "color": "blue",
        "deleted": false,
        "createdAt": "2025-12-17T02:34:55.531Z",
        "description": "Apply search-and-replace edit to a file"
      },
      {
        "id": 59,
        "type": "command",
        "text": "SearchFiles",
        "boundedContextId": 3,
        "color": "blue",
        "deleted": false,
        "createdAt": "2025-12-17T02:34:58.371Z",
        "description": "Search file contents or find files by pattern"
      },
      {
        "id": 60,
        "type": "command",
        "text": "ParseCommand",
        "boundedContextId": 4,
        "color": "blue",
        "deleted": false,
        "createdAt": "2025-12-17T02:35:07.805Z",
        "description": "Parse and validate CLI arguments"
      },
      {
        "id": 61,
        "type": "command",
        "text": "StartInteractiveMode",
        "boundedContextId": 4,
        "color": "blue",
        "deleted": false,
        "createdAt": "2025-12-17T02:35:10.682Z",
        "description": "Launch the interactive REPL"
      },
      {
        "id": 62,
        "type": "command",
        "text": "CreateSession",
        "boundedContextId": 4,
        "color": "blue",
        "deleted": false,
        "createdAt": "2025-12-17T02:35:13.394Z",
        "description": "Initialize a new conversation session"
      },
      {
        "id": 63,
        "type": "command",
        "text": "GatherContext",
        "boundedContextId": 4,
        "color": "blue",
        "deleted": false,
        "createdAt": "2025-12-17T02:35:15.717Z",
        "description": "Load project context files (CLAUDE.md)"
      },
      {
        "id": 64,
        "type": "command",
        "text": "InjectSystemReminder",
        "boundedContextId": 4,
        "color": "blue",
        "deleted": false,
        "createdAt": "2025-12-17T02:35:18.750Z",
        "description": "Add system reminder to conversation"
      }
    ],
    "nextItemId": 65
  }
}